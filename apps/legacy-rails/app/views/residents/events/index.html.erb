<% @submenu_title = Event.model_name.human(count: 2).capitalize; @submenu_item = 'events'; @action_for_search = search_events_path(query: params[:query], responsible: params[:responsible], order: params[:order], b: params[:b], c: params[:c]) %>

<div class="inner-section col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-2 col-sm-9 col-sm-offset-2 events-index" data-user="<%= current_user.role %>">

  <div class="cm-nav-links">
    <%= link_to t('events.upcoming'), events_path(query: params[:query], responsible: params[:responsible], order: params[:order], b: params[:b], c: params[:c]), class: @upcoming_tab %>
    <%= link_to t('events.past'), past_events_path(query: params[:query], responsible: params[:responsible], order: params[:order], b: params[:b], c: params[:c]), class: @past_tab %>

    <% if can? :create, Event %>
      <%= link_to '+ ' + t('general.create_record', record_name: Event.model_name.human.capitalize), '#', class: 'btn btn-primary',
        data: { toggle: 'modal', target: '#new-event-modal' } %>
    <% end %>
  </div>

  <div class="under-tabs">
    <%= render 'residents/events/filter', items: '#events .event', width_company: true, class_objects: 'events', with_filter_options: true %>
    <%= render 'shared/communities_filter_new',
      items: '#events .event',
      width_company: true,
      class_objects: 'events',
      with_filter_options: true,
      to_controller: @uri_path,
      data_by_community: @contacts_by_accountable %>
  </div>

  <% if @events.present? %>
    <div class="cols-divided-sm-2 load-more-at-bottom" id="events" data-next-path="<%= @next_path %>">
      <%= render partial: 'residents/events/event', collection: @events %>
    </div>
  <% else %>
    <%= render 'shared/empty_items', icon: 'fa-calendar', objects: Event.model_name.human(count: 2) %>
  <% end %>
  <div class='content-pagination'>
    <%= page_entries_info @contacts %>
    <%= will_paginate @contacts, :renderer => 'LinkRenderer' %>
  </div>
</div>

<% if can? :create, Event %>
  <div class="modal fade form-new-object" id="new-event-modal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
          <h4 class="modal-title"><%= t('general.create_record', record_name: Event.model_name.human.capitalize) %></h4>
        </div>
        <div class="modal-body">
          <%= render 'residents/events/form' %>
        </div>
      </div>
    </div>
  </div>
<% end %>