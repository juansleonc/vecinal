<% modal_target = "#update-folder-modal-#{folder.id}" %>
<div class="col-md-3 col-sm-4 col-xs-12 folder-container document" id="folder-<%= folder.id %>">
  <div class="link-dblclick no-selectable-text" data-path="<%= folder_path folder %>" data-target="<%= modal_target %>">
    <%= link_to '', folder, class: 'link-dblclick-target' %>
    <i class="fa fa-folder"></i>
    <div class="name">
      <%= content_with_emoji folder.name %>
    </div>
    <div class="document-details">
      <div class="creator">
        <%= folder.created_by ? folder.created_by.full_name : '' %>
      </div>
      <div class="date">
        <%= folder.updated_at.strftime '%d %b %y' %>
      </div>
      <div class="size">
        <%= number_to_human_size folder.size %>
      </div>
    </div>
  </div>

  <% if can?(:manage, folder) && folder.father.present? %>
    <div class="dropdown visible-sm visible-xs actions">
      <%= link_to '#', class: 'dropdown-toggle', data: {toggle: 'dropdown'} do %>
        <i class="fa fa-ellipsis-v"></i>
      <% end %>
      <ul class="dropdown-menu">
        <li>
          <%= link_to '#', data: {toggle: 'modal', target: modal_target } do %>
            <i class="fa fa-pencil-square-o"></i>
            <%= t 'folders.rename' %>
          <% end %>
        </li>
        <li>
          <%= confirm_destroy folder, remote: true do %>
            <i class="fa fa-trash-o"></i>
            <%= t 'folders.delete' %>
          <% end %>
        </li>
      </ul>
    </div>

    <div class="list-group contextual-menu hidden-xs hidden-sm">
      <%= link_to '#', class: 'list-group-item', data: {toggle: 'modal', target: modal_target } do %>
        <i class="fa fa-pencil-square-o"></i>
        <%= t 'folders.rename' %>
      <% end %>
      <%= link_to '#', class: 'delete list-group-item' do %>
        <i class="fa fa-trash-o"></i>
        <%= t 'folders.delete' %>
      <% end %>
    </div>

    <div class="modal fade form-new-object" id="update-folder-modal-<%= folder.id %>">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title"><%= t 'folders.rename' %></h4>
          </div>
          <div class="modal-body">
            <%= condomedia_form_for folder, remote: true do |f| %>
              <div class="folder-errors-container"></div>
              <div class="form-group emoji-picker-container normal-height">
                <%= f.text_field :name, class: 'form-control', data: { emojiable: true } %>
              </div>
              <%= f.submit t('general.save'), class: 'btn btn-primary' %>
              <button type="button" class="btn btn-default" data-dismiss="modal"><%= t 'general.cancel' %></button>
            <% end %>
          </div>
        </div>
      </div>
    </div>

  <% end %>
</div>